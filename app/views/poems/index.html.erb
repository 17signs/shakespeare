<div class="header">
  <div class="header_left">
    <h1>
      <% if params[:search] %>
        <%= t('.search_results_for') %>: <%= params[:search] %>
      <% else %>
        <%= t('.overview') %>
      <% end %>
    </h1>
  </div>
</div>
<div class="content2">
  <ul id="tabbed_menu">
    <% if @poem_types && @poem_types.to_a.length > 0 %>
      <li id="tab_poem_types"><%= t('.poem_types') %></li>
    <% end %>
    <% if @poems && @poems.to_a.length > 0 %>
      <li id="tab_poems"><%= t('.poems') %></li>
    <% end %>
    <% if @values && @values.to_a.length > 0 %>
      <li id="tab_values"><%= t('.values') %></li>
    <% end %>
  </ul>
  <div id="content_pane">
    <div id="pane_poem_types" class="hidden">
      <%= link_to t('.new_poem_type'), new_poem_path(:is_poem_type => true), :remote => true, :class => "button focus" %><br><br>
      <% if @poem_types && @poem_types.to_a.length > 0 %>
          <ul class="flat_list">
            <% @poem_types.each do |p| %>
              <li class="action_item"><%= link_to p, p, :class => 'link' %></li>
            <% end %>
          </ul>
      <% end %>
    </div>
    <div id="pane_poems" class="hidden">
      <%= link_to t('.new_poem'), new_poem_path, :remote => true, :class => "button focus" %><br><br>
      <% if @poems && @poems.to_a.length > 0  %>
        <ul class="flat_list">
          <% @poems.each do |p| %>
            <li class="action_item"><%= link_to p, p, :class => 'link' %></li>
          <% end %>
        </ul>
      <% end %>
    </div>
    <div id="pane_values" class="hidden">
      <% if @values && @values.to_a.length > 0  %>
        <table>
          <tr>
            <td class="label_cell"><%= t('poem_type') %></td>
            <td class="label_cell"><%= t('poem') %></td>
            <td class="label_cell"><%= t('attribute') %></td>
            <td class="label_cell"><%= t('value') %></td>
          </tr>
          <% @values.each do |v| %>
            <% if v.poem %>
              <tr class="row_highlight">
                <% if v.poem.parent == nil %>
                  <td class="value_cell"><%= t('.no_type') %></td>
                <% else %>
                  <td class="value_cell"><%= link_to v.poem.parent, v.poem.parent, :class => 'link' %></td>
                <% end %>
                <td class="value_cell"><%= link_to v.poem, v.poem, :class => 'link' %></td>
                <td class="value_cell"><%= v.name %></td>
                <td class="value_cell"><%= v.value %></td>
              </tr>
            <% end %>
          <% end %>
        </table>
      <% end %>
    </div>
  </div>
</div>

<script type="text/javascript">
  window.onload = function() {
    <% if @poems && @poems.to_a.length > 0 %>
      $('#tab_poems').addClass('active');
      $('#pane_poems').removeClass('hidden');
    <% else %>
      <% if @values && @values.to_a.length > 0 %>
        $('#tab_values').addClass('active');
        $('#pane_values').removeClass('hidden');
      <% else %>
        <% if @poem_types && @poem_types.to_a.length > 0 %>
          $('#tab_poem_types').addClass('active');
          $('#pane_poem_types').removeClass('hidden');
        <% end %>
      <% end %>
    <% end %>
  };
</script>