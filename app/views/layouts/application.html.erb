<!DOCTYPE html>
<html>
<head>
  <title>Shakespeare</title>
  <%= stylesheet_link_tag    'application', :media => 'all' %>
  <%= javascript_include_tag 'application' %>
  <%= javascript_include_tag 'rails' %>
  <%= javascript_include_tag 'raphael-min' %>
  <%= javascript_include_tag 'dracula_graffle' %>
  <%= javascript_include_tag 'dracula_graph' %>
  <%= javascript_include_tag 'dracula_algorithms' %>
  <%= csrf_meta_tags %>
</head>
<body>

<div class="main-nav-wrapper">
  <div class="nav_container">
    <div class="nav_content">
      <%= link_to t('.shakespeare'), mdms_path, :class => 'shakespeare' %>
      <div class="right">
        <%= form_tag poems_path, :method => :get do %>
            <%= submit_tag t('.search'), :name => nil, :style => 'display: none' %>
            <%= search_field_tag :search, '', :placeholder => 'search...' %>
        <% end %>
        <%= form_tag mdms_path, :class => 'locale' do %>
            <%= submit_tag 'submit' %>
            <%= select_tag 'set_locale', options_for_select(LANGUAGES, I18n.locale.to_s), :onchange => 'this.form.submit()', :style => 'display: none' %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<section class="container">
  <section class="content">
    <%= yield %>
  </section>
</section>

<section class="finder-container">
  <input id="finder" type="checkbox" />
  <label for="finder"><%= t('.finder') %></label>
    <%= finder %>
</section>

<div id="overlay">
  <div id="generic_dialog" class="overlay_dialog"></div>
</div>

<script type="text/javascript">
  $(document).ready(function() {
      $('.locale input').css("display", "none");
  });

  function overlay(dialog) {
      $(".overlay_dialog").each(function() {
          $(this).css("visibility", "hidden");
      });
      var el = document.getElementById("overlay");
      el.style.visibility = (el.style.visibility == "visible") ? "hidden" : "visible";
      if (el.style.visibility == "visible") {
          $('#'+dialog).css("visibility", "visible");
      }
  }

  function get_to_poems() {
      var rel_id = $('#relation_parent').val();
      var to_poems = $.ajax({
          type: "GET",
          url: "to_poems",
          data: {relation: rel_id},
          dataType: 'json',
          success: function (data) {
              var mySelect = $('#relation_to');
              mySelect.empty();
              $.each(data['poems'], function (index, element) {
                  mySelect.append(
                          $('<option></option>').val(element.id).html(element.poem_name)
                  );
              });
              $('#relation_from_to_phrase').val(data['ftp']);
              $('#relation_to_from_phrase').val(data['tfp']);
          }
      })
  }

  function toggle_phrases() {
      $('#new_rel_from_to_phrase').toggle();
      $('#new_rel_to_from_phrase').toggle();
  }

</script>

<%= yield :javascript %>

</body>
</html>